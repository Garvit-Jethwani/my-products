# ********RoostGPT********

# Test generated by RoostGPT for test karate-test-credential using AI Type Claude AI and AI Model claude-3-opus-20240229
# 
# Feature file generated for /login_post for http method type POST 
# RoostTestHash=3122292ee3
# 
# 

# ********RoostGPT********
Feature: Login API

Background:
  * def urlBase = karate.properties['url.base'] || karate.get('urlBase', 'http://localhost:8080')
  * url urlBase

  Scenario Outline: Login using OTP: creates a session
    Given path '/login'
    And request
      """
      {
        "email": "<email>",
        "otp": "<otp>",
        "client": "<client>"
      }
      """
    When method POST
    Then status 201
    And match header api-version == '1.0.0'
    And match response.token == '#regex ^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'

    Examples:
      | email                | otp    | client  |
      | user@example.com     | 123456 | mobile  |
      | test.user@domain.com | 654321 | web     |
      | admin@company.com    | 111111 | desktop |
      | api@service.com      | 999999 | api     |

  Scenario: Login with invalid email format
    Given path '/login'
    And request
      """
      {
        "email": "invalid_email",
        "otp": "123456",
        "client": "mobile"
      }
      """
    When method POST
    Then status 400
    And match header api-version == '1.0.0'
    And match response.error == 'validation/email-pattern'
    And match response.description == 'Descriptive Error Message'
    And match response.value == 'invalid_email'
    And match response.field == 'email'
    And match response.schema_field == 'email'

  Scenario: Login with missing required fields
    Given path '/login'
    And request
      """
      {
        "email": "user@example.com"
      }
      """
    When method POST
    Then status 400
    And match header api-version == '1.0.0'
    And match response.error == 'error/code'
    And match response.description == 'Descriptive Error Message'
